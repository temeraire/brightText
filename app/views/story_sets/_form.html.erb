<script>
  $(function(){
  	//set client_side_validation for selection list
   $("#story_set_category_id").change(function(){
		var settings = window[$('form[data-validate]').attr('id')];
		$("#story_set_name").isValid(settings.validators);		
   });
   
   $("#save_story_set_btn").button(); 
   $("#back_btn").button().click( function(e){
    e.preventDefault();
    document.location.href="/story_sets?filter=<%= @story_set.category_id.to_s %>"; 
    return false;    
   });; 
  });
  
  function onCategorySelect()
  {
    var selector =  $("#categorySelector")[0];
    $("#storySetId")[0].value = selector.options[ selector.selectedIndex ].value;
  }
</script>

<%= form_for(@story_set, :validate => true) do |f| %>
  <% if @story_set.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@story_set.errors.count, "error") %> prohibited this story_set from being saved:</h2>

      <ul>
      <% @story_set.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field form-field">
    <div class="form-field-label"><%= f.label :name %>:</div>
    <div class="form-field-value"><%= f.text_field :name %></div>
  </div>
  
  
  <div class="field form-field" >
    <div class="form-field-label"><%= session[:style].group_alias.titleize %>:</div>
    <div class="form-field-value">
    	<%= f.select :category_id, "<option>-- unassigned --</option>" + options_from_collection_for_select(StorySetCategory.where(:domain_id => session[:domain].id), :id, :name, @story_set.category_id) %>
    </div>
    
  </div>
  <% unless @stories.blank? %>  	  
	  <div class="field form-field" style="height: auto;">
	    <div class="form-field-label" style="width: auto; float: none;">Select Stories to clone:</div>
		<br />
	  	<% @stories.each do |story| %>
		    <div class="form-field-label"><%= check_box_tag "stories[]", story.id, true %></div>
		    <div class="form-field-value"><%= story.name %></div>
		    <br style="clear: both;" />
	    <% end %>
	  </div>
  <% end %>
  <div class="actions">
    <button style="height:28px; margin-right:480px" id="back_btn">Back</button><%= f.submit :id => "save_story_set_btn", :value => "Save" %>
  </div>
<% end %>
